<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <title>Rent Warehouse - 3 Step Wizard</title>
    <style>
    .hidden {
        display: none;
    }
    .step-container {
        margin: 20px 0;
    }
    .doba-option {
        display: inline-block;
        border: 1px solid #ccc;
        padding: 10px;
        margin: 5px;
        cursor: pointer;
        vertical-align: top;
    }
    .doba-option input[type="radio"] {
        margin-right: 5px;
    }

    /* –®–∞–ø–∫–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —à–∞–≥–æ–≤ (–ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä) */
    .progress-bar {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }
    .progress-bar .step {
        flex: 1;
        text-align: center;
        padding: 10px;
        border-bottom: 2px solid #ccc;
        position: relative;
    }
    .progress-bar .step.active {
        font-weight: bold;
        border-color: #007bff;
    }
    .progress-bar .step::after {
        content: '';
        position: absolute;
        width: 100%;
        bottom: -2px;
        left: 0;
        border-bottom: 2px dashed #ccc;
        z-index: -1;
    }
    .progress-bar .step:last-child::after {
        width: 0;
    }

    /* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (inline-–≤–∞–ª–∏–¥–∞—Ü–∏—è) */
    .invalid-input {
        border: 1px solid red;
    }
    .error-message {
        color: red;
        display: none;
        margin-left: 10px;
    }
    .error-message.active {
        display: inline;
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è kaucie */
    .modal-overlay {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.5);
        display: none;
    }
    .modal-content {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        background: #fff;
        padding: 20px;
        max-width: 600px;
        border-radius: 4px;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .modal-content .close-btn {
        float: right;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
    }
    .modal-content p {
        margin: 0;
        padding: 10px 0;
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ - —Ç–µ–ª–µ—Ñ–æ–Ω (–∏–∫–æ–Ω–∫–∞ –≤–æ–ø—Ä–æ—Å–∞) */
    .info-icon {
        display: inline-block;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background-color: #007bff;
        color: #fff;
        text-align: center;
        line-height: 18px;
        font-size: 14px;
        cursor: pointer;
        margin-left: 5px;
    }
    .phone-tooltip {
        position: absolute;
        background: #f2f2f2;
        border: 1px solid #ccc;
        padding: 10px;
        display: none;
        width: 220px;
        z-index: 100;
    }
    .sticker-badge {
        position: absolute;
        top: 0;
        right: 0;
        transform: translate(0, -50%);
        color: #fff;
        font-weight: bold;
        font-size: 0.9em;
        padding: 3px 8px;
        border-radius: 4px;
        /* –£–±—Ä–∞–ª–∏ background: –∑–¥–µ—Å—å, –∏–±–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–Ω—ã–µ —á–µ—Ä–µ–∑ –ø–æ–¥–∫–ª–∞—Å—Å—ã */
    }

    /* –ù–æ–≤—ã–π –∫–æ–¥: —Ä–∞–∑–Ω—ã–µ —Ñ–æ–Ω—ã */
    .sticker-badge.badge-popular {
        background: blue; /* –¥–ª—è 6mes */
    }
    .sticker-badge.badge-vyhodne {
        background: green;    /* –¥–ª—è 12mes */
    }
    .btn-next {
    margin-top: 20px;
    }
    </style>
</head>
<body>

<h1>Iba 3 kroky a TOP SKLAD je V√°≈°</h1>

<!-- –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏, –µ—Å–ª–∏ –µ—Å—Ç—å -->
{% if form.errors %}
<div style="color:red;">
    <strong>Form Errors:</strong>
    <ul>
        {% for field, errors in form.errors.items %}
            <li><strong>{{ field }}</strong>: {{ errors|join:", " }}</li>
        {% endfor %}
    </ul>
    <ul>
      {% for error in form.non_field_errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
</div>
{% endif %}

<!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
<div class="progress-bar">
    <div id="stepIndicator1" class="step active">1. V√Ωber skladu</div>
    <div id="stepIndicator2" class="step">2. √ödaje n√°jomcu</div>
    <div id="stepIndicator3" class="step">3. Prihlasovacie √∫daje</div>
</div>

<form method="post">
    {% csrf_token %}
    
    <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ, —á—Ç–æ–±—ã –ø—Ä–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –æ—à–∏–±–∫–µ –Ω–µ —Å–ª–µ—Ç–∞—Ç—å –Ω–∞ —à–∞–≥1 -->
    <input type="hidden" id="current_step" name="current_step" value="{{ current_step|default:'1' }}">

    <!-- –®–∞–≥ 1: V√Ωber skladu -->
    <div id="step1" class="step-container">
        <h2>Krok 1: V√Ωber skladu</h2>

        <p>Typ skladu: {{ form.typ_skladu }}</p>
        <p>Lokalita: {{ form.lokalita }}</p>

        <p>Prenaja≈• sklad od:
           <input type="date" name="prenajat_sklad_od" id="prenajat_sklad_od"
                  value="{{ form.prenajat_sklad_od.value|default_if_none:'' }}">
        </p>

        <p>Veƒækos≈• skladu: {{ form.velkost_skladu }}</p>

        <!-- –î–æ–±–∞–≤–ª—è–µ–º span —Å–ø—Ä–∞–≤–∞, –≥–¥–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "Plocha, Poschodie" -->
        <p>
          ƒå√≠slo skladu: {{ form.cislo_skladu }}
          <span id="sklad_info_span" style="margin-left: 15px; color: #444;"></span>
        </p>

        <div id="sklad_photos" style="display:flex; gap:10px; margin:5px 0;">
          <img id="sklad_foto_main"   src="" alt="hlavn√© foto"  style="width:200px; height:auto;" />
          <img id="sklad_foto_extra1" src="" alt="ƒèal≈°ie foto1" style="width:200px; height:auto;" />
          <img id="sklad_foto_extra2" src="" alt="ƒèal≈°ie foto2" style="width:200px; height:auto;" />
        </div>

        <p>Doba pren√°jmu:</p>
        <div id="doba_container"></div>

        <button type="button" id="btnStep1Next" class="btn-next">ƒéalej</button>
    </div>

    <!-- –®–∞–≥ 2: √ödaje n√°jomcu -->
    <div id="step2" class="step-container hidden">
        <h2>Krok 2: √ödaje n√°jomcu</h2>

        <div id="pravne_postavenie_block">
            <p>Pr√°vne postavenie n√°jomcu: {{ form.pravne_postavenie_najomcu }}</p>
        </div>

        <div id="dph_info" class="hidden">
            DPH vo v√Ω≈°ke 20% bude pripoƒç√≠tan√° k zobrazenej cene skladu vo f√°ze platby
        </div>

        <!-- Fyzick√° osoba -->
        <div id="fyzicka_osoba_fields" class="hidden">
            <p>
              Meno a priezvisko:
              {{ form.meno_a_priezvisko }}
              <span class="error-message" id="error_id_meno_a_priezvisko"></span>
            </p>
            <p>D√°tum narodenia:
               <input type="date" id="id_datum_narodenia" name="datum_narodenia"
                      value="{{ form.datum_narodenia.value|default_if_none:'' }}">
               <span class="error-message" id="error_id_datum_narodenia"></span>
            </p>
            <p>Adresa trval√©ho bydliska:</p>
            <p>
              Ulica:
              {{ form.ulica }}
              <span class="error-message" id="error_id_ulica"></span>
            </p>
            <p>
              ƒå√≠slo domu:
              {{ form.cislo_domu }}
              <span class="error-message" id="error_id_cislo_domu"></span>
            </p>
            <p>
              PSƒå:
              {{ form.psc }}
              <span class="error-message" id="error_id_psc"></span>
            </p>
            <p>
              Mesto:
              {{ form.mesto }}
              <span class="error-message" id="error_id_mesto"></span>
            </p>

            <!-- Krajina –¥–ª—è fyzicka -->
            <p>Krajina:
               <select id="id_krajina" name="krajina"></select>
               <span class="error-message" id="error_id_krajina"></span>
            </p>
        </div>

        <!-- Pr√°vnick√° osoba -->
        <div id="pravnicka_osoba_fields" class="hidden">
            <p>
              Nazov:
              {{ form.nazov }}
              <span class="error-message" id="error_id_nazov"></span>
            </p>
            <p>
              Zast√∫pen√Ω:
              {{ form.zastupeny }}
              <span class="error-message" id="error_id_zastupeny"></span>
            </p>
            <p>Sidlo:</p>
            <p>
              Ulica:
              {{ form.sidlo_ulica }}
              <span class="error-message" id="error_id_sidlo_ulica"></span>
            </p>
            <p>
              ƒå√≠slo domu:
              {{ form.sidlo_cislo_domu }}
              <span class="error-message" id="error_id_sidlo_cislo_domu"></span>
            </p>
            <p>
              PSƒå:
              {{ form.sidlo_psc }}
              <span class="error-message" id="error_id_sidlo_psc"></span>
            </p>
            <p>
              Mesto:
              {{ form.sidlo_mesto }}
              <span class="error-message" id="error_id_sidlo_mesto"></span>
            </p>
            <p>
              Krajina:
              <select id="id_sidlo_krajina" name="sidlo_krajina"></select>
              <span class="error-message" id="error_id_sidlo_krajina"></span>
            </p>
            <p>
              IƒåO:
              {{ form.ico }}
              <span class="error-message" id="error_id_ico"></span>
            </p>
            <p>
              DIƒå:
              {{ form.dic }}
              <span class="error-message" id="error_id_dic"></span>
            </p>
            <p id="ic_dph_block" class="hidden">
              Iƒå DPH:
              {{ form.ic_dph }}
              <span class="error-message" id="error_id_ic_dph"></span>
            </p>
        </div>

        <button type="button" id="btnStep2Back" class="btn-next">Sp√§≈•</button>
        <button type="button" id="btnStep2Next" class="btn-next">ƒéalej</button>
    </div>

    <!-- –®–∞–≥ 3: Prihlasovacie √∫daje -->
    <div id="step3" class="step-container hidden">
        <h2>Krok 3: Prihlasovacie √∫daje</h2>
        <div id="komunikacia_fields">
            <!-- –°–∫—Ä—ã—Ç—ã–π input, –∫—É–¥–∞ —Å–∫–ª–µ–∏–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä -->
            <input type="hidden" id="id_cislo_pre_komunikaciu" name="cislo_pre_komunikaciu"
                   value="{{ form.cislo_pre_komunikaciu.value|default_if_none:'' }}">

            <p>
              <label for="phone_code">Telef√≥nne ƒç√≠slo</label>
              <span class="info-icon" id="phoneInfoIcon">?</span>
              <span class="phone-tooltip" id="phoneTooltip">
                Zadajte va≈°e telef√≥nne ƒç√≠slo pre komunik√°ciu a pr√≠stup do skladu
              </span>
            </p>
            <p>
              <select id="phone_code" style="width:auto;"></select>
              <input type="text" id="phone_rest" style="width:150px;" placeholder="zvy≈°ok ƒç√≠sla">
              <span class="error-message" id="phone_error"></span>
            </p>

            <p>Email: {{ form.email }} <span class="error-message" id="error_id_email"></span></p>
            <p>Heslo (na pr√≠stup do √∫ƒçtu): {{ form.heslo }} 
            <span id="togglePassword" style="cursor:pointer; margin-left:5px;">üëÅÔ∏è</span>
            <span class="error-message" id="error_id_heslo"></span></p>
            <p>Opakovanie hesla:
            <input type="password" id="id_heslo_2" name="heslo_2" onpaste="return false;" />
            <span class="error-message" id="error_id_heslo_2"></span>
            <span id="ok_id_heslo_2" style="color:green; font-weight:bold; display:none;">‚úî</span></p>
            <p>
              Som obozn√°men√Ω (-√°) s 
              <a href="#" id="kaucieLink">podmienkou √∫ƒçtovan√≠ vratnej kaucie</a>:
              {{ form.suhlas_kaucia }}
            </p>
            <p>Som obozn√°men√Ω (-√°) s n√°jomnou zmluvou a bezv√Ωhradne ju prij√≠mam.: {{ form.suhlas_zmluva }}</p>
        </div>

        <button type="button" id="btnStep3Back" class="btn-next">Sp√§≈•</button>
        <!-- –ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —à–∞–≥–µ 3 –∫–Ω–æ–ø–∫–∞ disabled -->
        <button type="submit" id="rent_button" disabled>Prenaja≈• sklad</button>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {

  function loadLokalita(autoNext=true) {
    fetch(`/ajax/lokalita/?typ_skladu=${document.querySelector('#id_typ_skladu').value}`)
      .then(r=>r.json())
      .then(data=>{
        const lokalita=document.querySelector('#id_lokalita');
        lokalita.innerHTML='';
        if(data.length>0){
          data.forEach(val=>{
            const opt=document.createElement('option');
            opt.value=val; opt.textContent=val;
            lokalita.appendChild(opt);
          });
          lokalita.selectedIndex=0;
          if(autoNext) loadVelkost(true);
        }
      });
  }

  if (document.querySelector('#id_typ_skladu').value) {
    loadLokalita(true);
  }
});

// –ì–ª–∞–∑–æ–∫ –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–∞—Ä–æ–ª—è
document.addEventListener('DOMContentLoaded', function() {
    const hesloField = document.getElementById('id_heslo');
    const togglePassword = document.getElementById('togglePassword');

    togglePassword.addEventListener('click', () => {
        if (hesloField.type === 'password') {
            hesloField.type = 'text';
        } else {
            hesloField.type = 'password';
        }
    });
});

document.addEventListener('DOMContentLoaded', function() {
    const hesloField = document.getElementById('id_heslo');
    const heslo2Field = document.getElementById('id_heslo_2');
    const heslo2Error = document.getElementById('error_id_heslo_2');
    const heslo2OkMark = document.getElementById('ok_id_heslo_2');
    const rentButton = document.getElementById('rent_button');

    // –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—Å—Ç–∞–≤–∫—É –≤–æ –≤—Ç–æ—Ä–æ–µ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
    heslo2Field.addEventListener('paste', (e) => e.preventDefault());

    function checkPasswordsMatch() {
        const pass1 = hesloField.value.trim();
        const pass2 = heslo2Field.value.trim();

        if (!pass2) {
            heslo2Error.textContent = "";
            heslo2Error.classList.remove('active');
            heslo2Field.classList.remove('invalid-input');
            heslo2OkMark.style.display = 'none';
        } else if (pass1 !== pass2) {
            heslo2Error.textContent = "Hesl√° sa nezhoduj√∫. Pou≈æite rovnak√© heslo, pros√≠m.";
            heslo2Error.classList.add('active');
            heslo2Field.classList.add('invalid-input');
            heslo2OkMark.style.display = 'none';
        } else {
            heslo2Error.textContent = "";
            heslo2Error.classList.remove('active');
            heslo2Field.classList.remove('invalid-input');
            heslo2OkMark.style.display = 'inline';
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ
    hesloField.addEventListener('input', checkPasswordsMatch);
    heslo2Field.addEventListener('input', checkPasswordsMatch);
    heslo2Field.addEventListener('blur', checkPasswordsMatch);
});
</script>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è kaucie -->
<div class="modal-overlay" id="kaucieModalOverlay">
  <div class="modal-content">
    <span class="close-btn" id="kaucieModalClose">√ó</span>
    <p>Podƒæa ≈°tandardn√Ωch pravidiel n√°jmu, n√°jomca pri podpise zmluvy plat√≠ garanƒçn√Ω poplatok (kaucia)
       vo v√Ω≈°ke mesaƒçnej spl√°tky n√°jmu, ktor√° sa pri skonƒçen√≠ n√°jmu vracia n√°jomcovi.</p>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {

    /* ==========================
       (A) –û–ë–©–ê–Ø –õ–û–ì–ò–ö–ê, –®–ê–ì–ò 1..3
       ========================== */

    const currentStepVal = parseInt('{{ current_step|default:"1" }}', 10) || 1;

    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const step3 = document.getElementById('step3');

    const stepIndicator1 = document.getElementById('stepIndicator1');
    const stepIndicator2 = document.getElementById('stepIndicator2');
    const stepIndicator3 = document.getElementById('stepIndicator3');

    function showStep(stepNumber) {
        step1.classList.add('hidden');
        step2.classList.add('hidden');
        step3.classList.add('hidden');
        stepIndicator1.classList.remove('active');
        stepIndicator2.classList.remove('active');
        stepIndicator3.classList.remove('active');

        if (stepNumber === 1) {
            step1.classList.remove('hidden');
            stepIndicator1.classList.add('active');
        } else if (stepNumber === 2) {
            step2.classList.remove('hidden');
            stepIndicator2.classList.add('active');
        } else {
            step3.classList.remove('hidden');
            stepIndicator3.classList.add('active');
        }
        // –û–±–Ω–æ–≤–∏–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ hidden-–ø–æ–ª—è
        document.getElementById('current_step').value = stepNumber.toString();
    }

    /* ==========================
       (B) –î–ò–ù–ê–ú–ò–ö–ê: STEP 1
       ========================== */
    const typSkladu = document.querySelector('#id_typ_skladu');
    const lokalita = document.querySelector('#id_lokalita');
    const velkost = document.querySelector('#id_velkost_skladu');
    const cislo   = document.querySelector('#id_cislo_skladu');
    const dobaContainer = document.getElementById('doba_container');

    function restoreSelectedOption(selectEl, val) {
        let found = false;
        for (let i=0; i < selectEl.options.length; i++) {
            if (selectEl.options[i].value === val) {
                selectEl.selectedIndex = i;
                found = true;
                break;
            }
        }
        if (!found && selectEl.options.length > 0) {
            selectEl.selectedIndex = 0;
        }
    }

    function loadLokalita(autoNext=true) {
        const currentLocVal = lokalita.value;
        fetch(`/ajax/lokalita/?typ_skladu=${typSkladu.value}`)
            .then(r => r.json())
            .then(data => {
                lokalita.innerHTML = '';
                if (data.length > 0) {
                    data.forEach(val => {
                        const opt = document.createElement('option');
                        opt.value = val;
                        opt.textContent = val;
                        lokalita.appendChild(opt);
                    });
                    restoreSelectedOption(lokalita, currentLocVal);
                    if (autoNext) loadVelkost(true);
                } else {
                    lokalita.innerHTML = '<option value="">(empty)</option>';
                    velkost.innerHTML = '<option value="">(empty)</option>';
                    cislo.innerHTML = '<option value="">(empty)</option>';
                    dobaContainer.innerHTML = '';
                }
                updateVisibility();
            });
    }

    function loadVelkost(autoNext=true) {
        const currentVelVal = velkost.value;
        fetch(`/ajax/velkost/?typ_skladu=${typSkladu.value}&lokalita=${lokalita.value}`)
            .then(r => r.json())
            .then(data => {
                velkost.innerHTML = '';
                if (data.length > 0) {
                    data.forEach(val => {
                        const opt = document.createElement('option');
                        opt.value = val;
                        opt.textContent = val;
                        velkost.appendChild(opt);
                    });
                    restoreSelectedOption(velkost, currentVelVal);
                    if (autoNext) loadCislo(true);
                } else {
                    velkost.innerHTML = '<option value="">(empty)</option>';
                    cislo.innerHTML = '<option value="">(empty)</option>';
                    dobaContainer.innerHTML = '';
                }
                updateVisibility();
            });
    }

    function loadCislo(autoNext=true) {
        const currentCisloVal = cislo.value;
        fetch(`/ajax/cislo_skladu/?typ_skladu=${typSkladu.value}&lokalita=${lokalita.value}&velkost_skladu=${velkost.value}`)
            .then(r => r.json())
            .then(data => {
                cislo.innerHTML = '';
                if (data.length > 0) {
                    data.forEach(val => {
                        const opt = document.createElement('option');
                        opt.value = val;
                        opt.textContent = val;
                        cislo.appendChild(opt);
                    });
                    restoreSelectedOption(cislo, currentCisloVal);
                    if (autoNext) loadDobaPrenajmu();
                } else {
                    cislo.innerHTML = '<option value="">(empty)</option>';
                    dobaContainer.innerHTML = '';
                }

                updateVisibility();

                // [–ù–û–í–´–ô –í–´–ó–û–í] –ï—Å–ª–∏ cislo –≤—ã–±—Ä–∞–Ω–æ —É–∂–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ‚Äî —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º info
                showSkladInfo();
            });
    }

    cislo.addEventListener('change', () => {
        loadDobaPrenajmu();
        showSkladInfo();
    });


    function loadDobaPrenajmu() {
        fetch(`/ajax/doba_prenajmu/?cislo_skladu=${cislo.value}`)
            .then(r => r.json())
            .then(data => {
                dobaContainer.innerHTML = '';
                if (data.length > 0) {
                    // ... –≤–Ω—É—Ç—Ä–∏ then(data => { ...
                        data.forEach((item, index) => {
                            const label = document.createElement('label');
                            label.className = 'doba-option';
                            // –ü–æ–∑–≤–æ–ª–∏–º —Å—Ç–∏–∫–µ—Ä—É –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è
                            label.style.position = 'relative';

                            // –°–æ–∑–¥–∞—ë–º <input type="radio">
                            const radio = document.createElement('input');
                            radio.type = 'radio';
                            radio.name = 'doba_prenajmu';
                            radio.value = item.value;
                            if (index===0) radio.checked = true;
                            label.appendChild(radio);

                            // –†–∞–∑–Ω–æ—Å–∏–º —Ç–µ–∫—Å—Ç "–¥–æ —Å–∫–æ–±–æ–∫ / —Å–∫–æ–±–∫–∏" –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
                            const match = item.text.match(/^(.*?)\s*\((.*)\)\s*$/);
                            if (match) {
                                const topLine    = match[1].trim();
                                const secondLine = '(' + match[2].trim() + ')';
                                label.appendChild(document.createTextNode(topLine));
                                label.appendChild(document.createElement('br'));
                                label.appendChild(document.createTextNode(secondLine));
                            } else {
                                // –ï—Å–ª–∏ –Ω–µ—Ç —Å–∫–æ–±–æ–∫
                                label.appendChild(document.createTextNode(item.text));
                            }

                            // === –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –µ—Å–ª–∏ value=='6mes' ‚Üí ‚≠êÔ∏è Popul√°rne; –µ—Å–ª–∏ value=='12mes' ‚Üí üî• V√Ωhodn√©
                            let stickerText = '';
                            if (item.value === '6mes') {
                                stickerText = '‚≠êÔ∏è Popul√°rne';
                            } else if (item.value === '12mes') {
                                stickerText = 'üî• V√Ωhodn√©';
                            }

                            if (stickerText) {
                                const sticker = document.createElement('span');
                                sticker.className = 'sticker-badge';
                                sticker.textContent = stickerText;

                                // –ù–æ–≤—ã–π –∫–æ–¥: –µ—Å–ª–∏ 6mes ‚Üí –¥–æ–±–∞–≤–∏–º –∫–ª–∞—Å—Å "badge-popular",
                                //            –µ—Å–ª–∏ 12mes ‚Üí –∫–ª–∞—Å—Å "badge-vyhodne"
                                if (item.value === '6mes') {
                                    sticker.classList.add('badge-popular');
                                } else if (item.value === '12mes') {
                                    sticker.classList.add('badge-vyhodne');
                                }

                                label.appendChild(sticker);
                            }

                            dobaContainer.appendChild(label);
                            if (item.value === '3mes') {
                                dobaContainer.appendChild(document.createElement('br'));
                            }
                        });

                } else {
                    dobaContainer.textContent = "≈Ωiadne mo≈ænosti.";
                }
                updateVisibility();
            });
    }

    // [–ù–û–í–´–ô –ö–û–î] –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç skladova_plocha –∏ poschodie
    function showSkladInfo() {
    const cVal = cislo.value;
    if (!cVal) {
        document.getElementById('sklad_info_span').textContent = '';
        // + –æ—á–∏—Å—Ç–∏–º —Ñ–æ—Ç–æ
        document.getElementById('sklad_foto_main').src   = '';
        document.getElementById('sklad_foto_extra1').src = '';
        document.getElementById('sklad_foto_extra2').src = '';
        return;
    }
    fetch(`/ajax/get_sklad_info/?cislo_skladu=${cVal}`)
        .then(r => r.json())
        .then(info => {
            // –ü–õ–û–•–ê / POSCHODIE, –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
            if (info && info.plocha && info.poschodie) {
                document.getElementById('sklad_info_span').textContent =
                  `Plocha: ${info.plocha} m¬≤, Poschodie: ${info.poschodie}`;
            } else {
                document.getElementById('sklad_info_span').textContent = '';
            }

            // –ù–û–í–û–ï: —Ç—Ä–∏ —Ñ–æ—Ç–æ
            // –ï—Å–ª–∏ –±–µ–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –ø–æ–ª—è: foto_main, foto_extra1, foto_extra2
            document.getElementById('sklad_foto_main').src   = info.foto_main   || '';
            document.getElementById('sklad_foto_extra1').src = info.foto_extra1 || '';
            document.getElementById('sklad_foto_extra2').src = info.foto_extra2 || '';
        })
        .catch(err => {
            document.getElementById('sklad_info_span').textContent = '';
            // –°–±—Ä–æ—Å —Ñ–æ—Ç–æ
            document.getElementById('sklad_foto_main').src   = '';
            document.getElementById('sklad_foto_extra1').src = '';
            document.getElementById('sklad_foto_extra2').src = '';
        });
    }

    if (typSkladu) {
        typSkladu.addEventListener('change', ()=>loadLokalita(true));
        lokalita.addEventListener('change', ()=>loadVelkost(true));
        velkost.addEventListener('change', ()=>loadCislo(true));

        // [–ò–ó–ú–ï–ù–Å–ù–ù–´–ô –ö–û–î] –¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Å–º–µ–Ω–µ cislo ‚Äî –≤—ã–∑—ã–≤–∞–µ–º –∏ loadDobaPrenajmu, –∏ showSkladInfo
        cislo.addEventListener('change', () => {
            loadDobaPrenajmu();
            showSkladInfo();
        });

        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        loadLokalita(true);
    }

    /* ==========================
       (C) –®–ê–ì 2: Fyz / Pr√°vnick√°
       ========================== */
    const pravneSelect = document.querySelector('#id_pravne_postavenie_najomcu');
    const dphInfo = document.getElementById('dph_info');

    const fyzickaFields = document.getElementById('fyzicka_osoba_fields');
    const pravnickaFields = document.getElementById('pravnicka_osoba_fields');
    const icDphBlock = document.getElementById('ic_dph_block');

    const menoField = document.querySelector('#id_meno_a_priezvisko');
    const nazovField = document.querySelector('#id_nazov');
    const datumNarodenia = document.querySelector('#id_datum_narodenia');

    /* –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª—è –ö—Ä–∞–π–Ω–∞ (fyzicka / pravnicka) - –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –∏–∑ JS */
    const countrySelectFyz  = document.getElementById('id_krajina');
    const countrySelectPrav = document.getElementById('id_sidlo_krajina');
    const originalFyzVal    = '{{ form.krajina.value|default_if_none:"Slovensko" }}';
    const originalPravVal   = '{{ form.sidlo_krajina.value|default_if_none:"Slovensko" }}';

    /* –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω –¥–ª—è Krajina (—Ç–æ—Ç –∂–µ, —á—Ç–æ –∏ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤) */
    const countriesAll = [
      "Slovensko","Afganistan","Alb√°nsko","Alja≈°ka","Al≈æ√≠rsko","Andora","Angola","Anguila","Antigua a Barbuda","Argent√≠na","Arm√©nsko","Aruba","Ascension","Austr√°lia","Austr√°lske extern√© √∫zemia","Azerbajd≈æan","Azorsk√© ostrovy","Bahamy","Bahrajn","Banglad√©≈°","Barbados","Belgicko","Belize","Benin","Bermudy","Bhut√°n","Bielorusko","Bol√≠via","Bosna a Hercegovina","Botswana","Braz√≠lia","Brunei","Bulharsko","Burkina Faso","Burundi","Cyprus","ƒåad","ƒåesk√° republika","ƒåierna Hora","ƒå√≠na","D√°nsko","Demokratick√° rep. Kongo","Diego Garcia","Dominika","Dominik√°nska republika","D≈æibuti","Egypt","Ekv√°dor","Eritrea","Est√≥nsko","Eti√≥pia","Faersk√© ostrovy","Falklandy - Malv√≠ny","Fid≈æi","Filip√≠ny","F√≠nsko","Franc√∫zsko","Gabun","Gambia","Ghana","Gibraltar","Gr√©cko","Grenada","Gr√≥nsko","Gruz√≠nsko","Guadeloupe","Guam","Guatemala","Guinea - Bissau","Guinea - republika","Guyana - Franc√∫zska","Guyana - republika","Haiti","Holandsk√© Antily","Holandsko","Honduras","Hongkong","Chile","Chorv√°tsko","India","Indon√©zia","Irak","Ir√°n","√çrsko","Island","Izrael","Jamajka","Japonsko","Jemen","Jord√°nsko","JAR - Juhoafr. Rep.","Juhosl√°via (Srbsko)","Kajmansk√© ostrovy","Kambod≈æa","Kamerun","Kanada","Kapverdy","Katar","Kazachstan","Ke≈àa","Kirgizstan","Kiribati","Kolumbia","Komory a Mayotte","Kongo","K√≥rea - Ju≈æn√°","K√≥rea - Severn√° - KƒΩDR","Kookove ostrovy","Kostarika","Kuba","Kuvajt","Laos","Lesotho","Libanon","Lib√©ria","L√≠bya","Lichten≈°tajnsko","Litva","Loty≈°sko","Luxembursko","Macao","Maced√≥nia","Madagaskar","Maƒèarsko","Madeira","Malajzia","Malawi","Maledivy","Mali","Malta","Mariany - Severn√©","Maroko","Marshallove ostrovy","Martinik","Mauret√°nia","Maur√≠cius","Mexiko","Mikron√©zia","Moldavsko","Monako","Mongolsko","Montserrat","Mozambik","Myanmar","Nam√≠bia","Nauru","Nemecko","Nep√°l","Niger","Nig√©ria","Nikaragua","Niue","N√≥rsko","Nov√° Kaled√≥nia","Nov√Ω Z√©land","Om√°n","Pakistan","Palau","Palest√≠na","Panama","Panensk√© ostrovy - GB","Panensk√© ostrovy - USA","Papua - Nov√° Guinea","Paraguay","Peru","Pobre≈æie slonoviny","Polyn√©zia - FR","Poƒæsko","Portoriko","Portugalsko (Azory a Madeira)","Rak√∫sko","Reunion","Rovn√≠kov√° Guinea","Rumunsko","Rusko","Rwanda","SAE - Spoj. Arab. Emir√°ty","Salvador","Samoa - USA","Samoa - z√°padn√°","San Marino","Saudsk√° Ar√°bia","Senegal","Seyschely","Sierra Leone","Singapur","Slovinsko","Som√°lsko","Srbsko (Juhosl√°via)","Sr√≠ Lanka (Cejl√≥n)","Stredoafr. Rep.","Sud√°n","Surinam","Sv√§t√° Helena","Sv√§t√° Lucia","Sv√§t√Ω Kri≈°tof a Nevis","Sv√§t√Ω Peter a Michal","Sv√§t√Ω Tom√°≈° a Princov ostrov","Sv√§t√Ω Vincent a Grenad√≠ny","Svazijsko","S√Ωria","≈†alam√∫nove ostrovy","≈†panielsko","≈†vajƒçiarsko","≈†V√âDSKO","Tad≈æikistan","Tahiti","Taliansko","Tanz√°nia","Thajsko","Tchaj-wan","Togo","Tokelau","Tonga","Trinidad a Tobago","Tunis","Turecko","Turkmenistan","Turky","Tuvalu","Uganda","Ukrajina","Uruguay","USA","Uzbekistan","Vanuatu","Vatik√°n","Veƒæk√° Brit√°nia a Sev. √çrsko","Venezuela","Vietnam","Wallis a Futuna","Zambia","Zimbabwe"
    ];

    const countryToCode = {
      "Afganistan":"+93","Alb√°nsko":"+355","Alja≈°ka":"+1907","Al≈æ√≠rsko":"+213","Andora":"+376","Angola":"+244",
      "Anguila":"+1264","Antigua a Barbuda":"+1268","Argent√≠na":"+54","Arm√©nsko":"+374","Aruba":"+297","Ascension":"+247",
      "Austr√°lia":"+61","Austr√°lske extern√© √∫zemia":"+672","Azerbajd≈æan":"+994","Azorsk√© ostrovy":"+351","Bahamy":"+1242",
      "Bahrajn":"+973","Banglad√©≈°":"+880","Barbados":"+1246","Belgicko":"+32","Belize":"+501","Benin":"+229","Bermudy":"+1441",
      "Bhut√°n":"+975","Bielorusko":"+375","Bol√≠via":"+591","Bosna a Hercegovina":"+387","Botswana":"+267","Braz√≠lia":"+55",
      "Brunei":"+673","Bulharsko":"+359","Burkina Faso":"+226","Burundi":"+257","Cyprus":"+357","ƒåad":"+235",
      "ƒåesk√° republika":"+420","ƒåierna Hora":"+381","ƒå√≠na":"+86","D√°nsko":"+45","Demokratick√° rep. Kongo":"+243",
      "Diego Garcia":"+246","Dominika":"+1767","Dominik√°nska republika":"+1809","D≈æibuti":"+253","Egypt":"+20","Ekv√°dor":"+593",
      "Eritrea":"+291","Est√≥nsko":"+372","Eti√≥pia":"+251","Faersk√© ostrovy":"+298","Falklandy - Malv√≠ny":"+500","Fid≈æi":"+679",
      "Filip√≠ny":"+63","F√≠nsko":"+358","Franc√∫zsko":"+33","Gabun":"+241","Gambia":"+220","Ghana":"+233","Gibraltar":"+350",
      "Gr√©cko":"+30","Grenada":"+1473","Gr√≥nsko":"+299","Gruz√≠nsko":"+995","Guadeloupe":"+590","Guam":"+671","Guatemala":"+502",
      "Guinea - Bissau":"+245","Guinea - republika":"+224","Guyana - Franc√∫zska":"+594","Guyana - republika":"+592","Haiti":"+509",
      "Holandsk√© Antily":"+599","Holandsko":"+31","Honduras":"+504","Hongkong":"+852","Chile":"+56","Chorv√°tsko":"+385",
      "India":"+91","Indon√©zia":"+62","Irak":"+964","Ir√°n":"+98","√çrsko":"+353","Island":"+354","Izrael":"+972","Jamajka":"+1876",
      "Japonsko":"+81","Jemen":"+967","Jord√°nsko":"+962","JAR - Juhoafr. Rep.":"+27","Juhosl√°via (Srbsko)":"+381","Kajmansk√© ostrovy":"+1345",
      "Kambod≈æa":"+855","Kamerun":"+237","Kanada":"+1","Kapverdy":"+238","Katar":"+974","Kazachstan":"+7","Ke≈àa":"+254","Kirgizstan":"+996",
      "Kiribati":"+686","Kolumbia":"+57","Komory a Mayotte":"+269","Kongo":"+242","K√≥rea - Ju≈æn√°":"+82","K√≥rea - Severn√° - KƒΩDR":"+850",
      "Kookove ostrovy":"+682","Kostarika":"+506","Kuba":"+53","Kuvajt":"+965","Laos":"+856","Lesotho":"+266","Libanon":"+961",
      "Lib√©ria":"+231","L√≠bya":"+218","Lichten≈°tajnsko":"+423","Litva":"+370","Loty≈°sko":"+371","Luxembursko":"+352","Macao":"+853",
      "Maced√≥nia":"+389","Madagaskar":"+261","Maƒèarsko":"+36","Madeira":"+351","Malajzia":"+60","Malawi":"+265","Maledivy":"+960",
      "Mali":"+223","Malta":"+356","Mariany - Severn√©":"+1670","Maroko":"+212","Marshallove ostrovy":"+692","Martinik":"+596",
      "Mauret√°nia":"+222","Maur√≠cius":"+230","Mexiko":"+52","Mikron√©zia":"+691","Moldavsko":"+373","Monako":"+377","Mongolsko":"+976",
      "Montserrat":"+1664","Mozambik":"+258","Myanmar":"+95","Nam√≠bia":"+264","Nauru":"+674","Nemecko":"+49","Nep√°l":"+977","Niger":"+227",
      "Nig√©ria":"+234","Nikaragua":"+505","Niue":"+683","N√≥rsko":"+47","Nov√° Kaled√≥nia":"+687","Nov√Ω Z√©land":"+64","Om√°n":"+968",
      "Pakistan":"+92","Palau":"+680","Palest√≠na":"+970","Panama":"+507","Panensk√© ostrovy - GB":"+1284","Panensk√© ostrovy - USA":"+1340",
      "Papua - Nov√° Guinea":"+675","Paraguay":"+595","Peru":"+51","Pobre≈æie slonoviny":"+225","Polyn√©zia - FR":"+689","Poƒæsko":"+48",
      "Portoriko":"+1787","Portugalsko (Azory a Madeira)":"+351","Rak√∫sko":"+43","Reunion":"+262","Rovn√≠kov√° Guinea":"+240","Rumunsko":"+40",
      "Rusko":"+7","Rwanda":"+250","SAE - Spoj. Arab. Emir√°ty":"+971","Salvador":"+503","Samoa - USA":"+684","Samoa - z√°padn√°":"+685",
      "San Marino":"+378","Saudsk√° Ar√°bia":"+966","Senegal":"+221","Seyschely":"+248","Sierra Leone":"+232","Singapur":"+65","Slovinsko":"+386",
      "Som√°lsko":"+252","Srbsko (Juhosl√°via)":"+381","Sr√≠ Lanka (Cejl√≥n)":"+94","Stredoafr. Rep.":"+236","Sud√°n":"+249","Surinam":"+597",
      "Sv√§t√° Helena":"+290","Sv√§t√° Lucia":"+1758","Sv√§t√Ω Kri≈°tof a Nevis":"+1869","Sv√§t√Ω Peter a Michal":"+508",
      "Sv√§t√Ω Tom√°≈° a Princov ostrov":"+239","Sv√§t√Ω Vincent a Grenad√≠ny":"+1809","Svazijsko":"+268","S√Ωria":"+963",
      "≈†alam√∫nove ostrovy":"+677","≈†panielsko":"+34","≈†vajƒçiarsko":"+41","≈†V√âDSKO":"+46","Tad≈æikistan":"+992","Tahiti":"+689",
      "Taliansko":"+39","Tanz√°nia":"+255","Thajsko":"+66","Tchaj-wan":"+886","Togo":"+228","Tokelau":"+690","Tonga":"+676",
      "Trinidad a Tobago":"+1868","Tunis":"+216","Turecko":"+90","Turkmenistan":"+993","Turky":"+1649","Tuvalu":"+688","Uganda":"+256",
      "Ukrajina":"+380","Uruguay":"+598","USA":"+1","Uzbekistan":"+998","Vanuatu":"+678","Vatik√°n":"+39",
      "Veƒæk√° Brit√°nia a Sev. √çrsko":"+44","Venezuela":"+58","Vietnam":"+84","Wallis a Futuna":"+681","Zambia":"+260","Zimbabwe":"+263",
      "Slovensko":"+421"
    };

    function fillCountrySelect(selectEl, selectedVal) {
      selectEl.innerHTML = '';
      countriesAll.forEach(country => {
        const opt = document.createElement('option');
        opt.value = country;
        opt.textContent = country;
        if (country === selectedVal) {
          opt.selected = true;
        }
        selectEl.appendChild(opt);
      });
    }

    fillCountrySelect(countrySelectFyz, originalFyzVal);
    fillCountrySelect(countrySelectPrav, originalPravVal);

    function setDatumNarodeniaRequired(isRequired) {
        if (!datumNarodenia) return;
        if (isRequired) {
            datumNarodenia.setAttribute('required','required');
        } else {
            datumNarodenia.removeAttribute('required');
        }
    }

    function updateVisibility() {
        const pravneVal = pravneSelect.value || "";
        if (pravneVal === "Pr√°vnick√° osoba (platca DPH)") {
            dphInfo.classList.remove('hidden');
        } else {
            dphInfo.classList.add('hidden');
        }

        if (pravneVal === "Fyzick√° osoba") {
            fyzickaFields.classList.remove('hidden');
            setDatumNarodeniaRequired(true);
        } else {
            fyzickaFields.classList.add('hidden');
            setDatumNarodeniaRequired(false);
        }

        if (pravneVal === "Pr√°vnick√° osoba (bez DPH)" || pravneVal === "Pr√°vnick√° osoba (platca DPH)") {
            pravnickaFields.classList.remove('hidden');
            if (pravneVal === "Pr√°vnick√° osoba (platca DPH)") {
                icDphBlock.classList.remove('hidden');
            } else {
                icDphBlock.classList.add('hidden');
            }
        } else {
            pravnickaFields.classList.add('hidden');
        }
        checkStep3Validity(); // —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–ª—è—Ç—å enable/disable –∫–Ω–æ–ø–∫–∏ –Ω–∞ 3-–º —à–∞–≥–µ
    }
    pravneSelect.addEventListener('change', updateVisibility);

    /* ==========================
       (D) –®–ê–ì 3: –ü–æ–ª—è + –≤–∞–ª–∏–¥–∞—Ü–∏—è
       ========================== */
    const phoneCodeSelect = document.getElementById('phone_code');
    const phoneRestInput  = document.getElementById('phone_rest');
    const phoneErrorSpan  = document.getElementById('phone_error');
    const finalPhoneHidden= document.getElementById('id_cislo_pre_komunikaciu');
    const emailField      = document.querySelector('#id_email');
    const hesloField      = document.querySelector('#id_heslo');
    const suhlasKaucia    = document.querySelector('#id_suhlas_kaucia');
    const suhlasZmluva    = document.querySelector('#id_suhlas_zmluva');
    const rentButton      = document.getElementById('rent_button');

    // –ù–∞–ø–æ–ª–Ω–∏–º phone_code
    const countryToDialMap = {
      "Afganistan":"+93","Alb√°nsko":"+355","Alja≈°ka":"+1907","Al≈æ√≠rsko":"+213","Andora":"+376","Angola":"+244",
      "Anguila":"+1264","Antigua a Barbuda":"+1268","Argent√≠na":"+54","Arm√©nsko":"+374","Aruba":"+297","Ascension":"+247",
      "Austr√°lia":"+61","Austr√°lske extern√© √∫zemia":"+672","Azerbajd≈æan":"+994","Azorsk√© ostrovy":"+351","Bahamy":"+1242",
      "Bahrajn":"+973","Banglad√©≈°":"+880","Barbados":"+1246","Belgicko":"+32","Belize":"+501","Benin":"+229","Bermudy":"+1441",
      "Bhut√°n":"+975","Bielorusko":"+375","Bol√≠via":"+591","Bosna a Hercegovina":"+387","Botswana":"+267","Braz√≠lia":"+55",
      "Brunei":"+673","Bulharsko":"+359","Burkina Faso":"+226","Burundi":"+257","Cyprus":"+357","ƒåad":"+235",
      "ƒåesk√° republika":"+420","ƒåierna Hora":"+381","ƒå√≠na":"+86","D√°nsko":"+45","Demokratick√° rep. Kongo":"+243",
      "Diego Garcia":"+246","Dominika":"+1767","Dominik√°nska republika":"+1809","D≈æibuti":"+253","Egypt":"+20","Ekv√°dor":"+593",
      "Eritrea":"+291","Est√≥nsko":"+372","Eti√≥pia":"+251","Faersk√© ostrovy":"+298","Falklandy - Malv√≠ny":"+500","Fid≈æi":"+679",
      "Filip√≠ny":"+63","F√≠nsko":"+358","Franc√∫zsko":"+33","Gabun":"+241","Gambia":"+220","Ghana":"+233","Gibraltar":"+350",
      "Gr√©cko":"+30","Grenada":"+1473","Gr√≥nsko":"+299","Gruz√≠nsko":"+995","Guadeloupe":"+590","Guam":"+671","Guatemala":"+502",
      "Guinea - Bissau":"+245","Guinea - republika":"+224","Guyana - Franc√∫zska":"+594","Guyana - republika":"+592","Haiti":"+509",
      "Holandsk√© Antily":"+599","Holandsko":"+31","Honduras":"+504","Hongkong":"+852","Chile":"+56","Chorv√°tsko":"+385",
      "India":"+91","Indon√©zia":"+62","Irak":"+964","Ir√°n":"+98","√çrsko":"+353","Island":"+354","Izrael":"+972","Jamajka":"+1876",
      "Japonsko":"+81","Jemen":"+967","Jord√°nsko":"+962","JAR - Juhoafr. Rep.":"+27","Juhosl√°via (Srbsko)":"+381","Kajmansk√© ostrovy":"+1345",
      "Kambod≈æa":"+855","Kamerun":"+237","Kanada":"+1","Kapverdy":"+238","Katar":"+974","Kazachstan":"+7","Ke≈àa":"+254","Kirgizstan":"+996",
      "Kiribati":"+686","Kolumbia":"+57","Komory a Mayotte":"+269","Kongo":"+242","K√≥rea - Ju≈æn√°":"+82","K√≥rea - Severn√° - KƒΩDR":"+850",
      "Kookove ostrovy":"+682","Kostarika":"+506","Kuba":"+53","Kuvajt":"+965","Laos":"+856","Lesotho":"+266","Libanon":"+961",
      "Lib√©ria":"+231","L√≠bya":"+218","Lichten≈°tajnsko":"+423","Litva":"+370","Loty≈°sko":"+371","Luxembursko":"+352","Macao":"+853",
      "Maced√≥nia":"+389","Madagaskar":"+261","Maƒèarsko":"+36","Madeira":"+351","Malajzia":"+60","Malawi":"+265","Maledivy":"+960",
      "Mali":"+223","Malta":"+356","Mariany - Severn√©":"+1670","Maroko":"+212","Marshallove ostrovy":"+692","Martinik":"+596",
      "Mauret√°nia":"+222","Maur√≠cius":"+230","Mexiko":"+52","Mikron√©zia":"+691","Moldavsko":"+373","Monako":"+377","Mongolsko":"+976",
      "Montserrat":"+1664","Mozambik":"+258","Myanmar":"+95","Nam√≠bia":"+264","Nauru":"+674","Nemecko":"+49","Nep√°l":"+977","Niger":"+227",
      "Nig√©ria":"+234","Nikaragua":"+505","Niue":"+683","N√≥rsko":"+47","Nov√° Kaled√≥nia":"+687","Nov√Ω Z√©land":"+64","Om√°n":"+968",
      "Pakistan":"+92","Palau":"+680","Palest√≠na":"+970","Panama":"+507","Panensk√© ostrovy - GB":"+1284","Panensk√© ostrovy - USA":"+1340",
      "Papua - Nov√° Guinea":"+675","Paraguay":"+595","Peru":"+51","Pobre≈æie slonoviny":"+225","Polyn√©zia - FR":"+689","Poƒæsko":"+48",
      "Portoriko":"+1787","Portugalsko (Azory a Madeira)":"+351","Rak√∫sko":"+43","Reunion":"+262","Rovn√≠kov√° Guinea":"+240","Rumunsko":"+40",
      "Rusko":"+7","Rwanda":"+250","SAE - Spoj. Arab. Emir√°ty":"+971","Salvador":"+503","Samoa - USA":"+684","Samoa - z√°padn√°":"+685",
      "San Marino":"+378","Saudsk√° Ar√°bia":"+966","Senegal":"+221","Seyschely":"+248","Sierra Leone":"+232","Singapur":"+65","Slovinsko":"+386",
      "Som√°lsko":"+252","Srbsko (Juhosl√°via)":"+381","Sr√≠ Lanka (Cejl√≥n)":"+94","Stredoafr. Rep.":"+236","Sud√°n":"+249","Surinam":"+597",
      "Sv√§t√° Helena":"+290","Sv√§t√° Lucia":"+1758","Sv√§t√Ω Kri≈°tof a Nevis":"+1869","Sv√§t√Ω Peter a Michal":"+508",
      "Sv√§t√Ω Tom√°≈° a Princov ostrov":"+239","Sv√§t√Ω Vincent a Grenad√≠ny":"+1809","Svazijsko":"+268","S√Ωria":"+963",
      "≈†alam√∫nove ostrovy":"+677","≈†panielsko":"+34","≈†vajƒçiarsko":"+41","≈†V√âDSKO":"+46","Tad≈æikistan":"+992","Tahiti":"+689",
      "Taliansko":"+39","Tanz√°nia":"+255","Thajsko":"+66","Tchaj-wan":"+886","Togo":"+228","Tokelau":"+690","Tonga":"+676",
      "Trinidad a Tobago":"+1868","Tunis":"+216","Turecko":"+90","Turkmenistan":"+993","Turky":"+1649","Tuvalu":"+688","Uganda":"+256",
      "Ukrajina":"+380","Uruguay":"+598","USA":"+1","Uzbekistan":"+998","Vanuatu":"+678","Vatik√°n":"+39",
      "Veƒæk√° Brit√°nia a Sev. √çrsko":"+44","Venezuela":"+58","Vietnam":"+84","Wallis a Futuna":"+681","Zambia":"+260","Zimbabwe":"+263",
      "Slovensko":"+421"
    };
    const sortedCountries = Object.keys(countryToDialMap).sort();
    sortedCountries.forEach(country => {
      const code = countryToDialMap[country];
      const opt = document.createElement('option');
      opt.value = code;
      opt.textContent = code;
      phoneCodeSelect.appendChild(opt);
    });

    // –ü–æ–¥–Ω–∏–º–∞–µ–º —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω (–µ—Å–ª–∏ –µ—Å—Ç—å)
    function restorePhone() {
      const existing = finalPhoneHidden.value;
      if (!existing) {
        // –µ—Å–ª–∏ –ø—É—Å—Ç–æ–π, default +421
        phoneCodeSelect.value = "+421";
        phoneRestInput.value = "";
        return;
      }
      // –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∫–æ–¥
      let matched = false;
      for (let i=0; i<phoneCodeSelect.options.length; i++) {
        const code = phoneCodeSelect.options[i].value;
        if (existing.startsWith(code)) {
          phoneCodeSelect.value = code;
          phoneRestInput.value = existing.substring(code.length);
          matched = true;
          break;
        }
      }
      if (!matched) {
        phoneCodeSelect.value = "+421";
        phoneRestInput.value  = existing; 
      }
    }
    restorePhone();

    let phoneCodeUserOverridden = false;
    phoneCodeSelect.addEventListener('change', () => {
      phoneCodeUserOverridden = true;
      syncPhoneField();
      checkStep3Validity();
    });
    phoneRestInput.addEventListener('input', () => {
      const val = phoneRestInput.value.trim();
      if (!val) {
        // –ï—Å–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
        phoneErrorSpan.textContent = "Telef√≥nne ƒç√≠slo mus√≠ by≈• zadan√©";
        phoneErrorSpan.classList.add('active');
        phoneRestInput.classList.add('invalid-input');
      } else if (val.startsWith('0')) {
        phoneErrorSpan.textContent = "Telef√≥nne ƒç√≠slo nem√¥≈æe zaƒç√≠na≈• ƒç√≠slom 0";
        phoneErrorSpan.classList.add('active');
        phoneRestInput.classList.add('invalid-input');
      } else {
        phoneErrorSpan.textContent = "";
        phoneErrorSpan.classList.remove('active');
        phoneRestInput.classList.remove('invalid-input');
      }
      syncPhoneField();
      checkStep3Validity();
    });

    function syncPhoneField() {
      finalPhoneHidden.value = phoneCodeSelect.value.trim() + phoneRestInput.value.trim();
    }

    // –ì–∞–ª–æ—á–∫–∏
    suhlasKaucia.addEventListener('change', checkStep3Validity);
    suhlasZmluva.addEventListener('change', checkStep3Validity);
    hesloField.addEventListener('input', checkStep3Validity);
    emailField.addEventListener('input', checkStep3Validity);

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π 3-–≥–æ —à–∞–≥–∞; –µ—Å–ª–∏ –≤—Å—ë –æ–∫, –∫–Ω–æ–ø–∫—É —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
    function checkStep3Validity() {
      let valid = true;

      // 1) –Ø–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
      const val = phoneRestInput.value.trim();
      if (!val) {
        phoneErrorSpan.textContent = "Telef√≥nne ƒç√≠slo mus√≠ by≈• zadan√©";
        phoneErrorSpan.classList.add('active');
        phoneRestInput.classList.add('invalid-input');
        valid = false;
      } else if (val.startsWith('0')) {
        phoneErrorSpan.textContent = "Telef√≥nne ƒç√≠slo nem√¥≈æe zaƒç√≠na≈• ƒç√≠slom 0";
        phoneErrorSpan.classList.add('active');
        phoneRestInput.classList.add('invalid-input');
        valid = false;
      } else {
        phoneErrorSpan.textContent = "";
        phoneErrorSpan.classList.remove('active');
        phoneRestInput.classList.remove('invalid-input');
      }
      // 2) email
      const emailVal = emailField.value.trim();
      if (!emailVal.includes("@") || !emailVal.includes(".")) { 
        valid = false; 
      }
      // 3) heslo (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–µ –ø—É—Å—Ç–æ–µ, –∏–ª–∏ –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞)
      if (!hesloField.value.trim()) {
        valid = false;
      }
      // 4) kaucia
      if (!suhlasKaucia.checked) valid = false;
      // 5) zmluva
      if (!suhlasZmluva.checked) valid = false;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∞–∫–∂–µ –≥–∞–ª–æ—á–∫–∏
      if (valid && suhlasKaucia.checked && suhlasZmluva.checked) {
        rentButton.removeAttribute('disabled');
      } else {
        rentButton.setAttribute('disabled','disabled');
      }
    }

    // –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ disabled –∫–Ω–æ–ø–∫—É –≤—ã–¥–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    rentButton.addEventListener('click', (e) => {
      if (rentButton.hasAttribute('disabled')) {
        e.preventDefault();
        alert("Pros√≠m, vypl≈àte v≈°etky polia na Krok 3 spr√°vne, aby ste mohli pokraƒçova≈•.");
        return false;
      }
    });

    const phoneInfoIcon = document.getElementById('phoneInfoIcon');
    const phoneTooltip  = document.getElementById('phoneTooltip');

    phoneInfoIcon.addEventListener('click', ()=>{
      if (phoneTooltip.style.display === 'block') {
        phoneTooltip.style.display = 'none';
      } else {
        phoneTooltip.style.display = 'block';
        // –º–æ–∂–Ω–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å toolip –≤–æ–∑–ª–µ –∏–∫–æ–Ω–∫–∏:
        const rect = phoneInfoIcon.getBoundingClientRect();
        phoneTooltip.style.position = 'absolute';
        phoneTooltip.style.left = rect.left + 'px';
        phoneTooltip.style.top = (rect.bottom + 5) + 'px';
      }
    });

    // –∫–ª–∏–∫ –≤–Ω–µ —Ç—É–ª—Ç–∏–ø–∞, —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å
    document.addEventListener('click',(ev)=>{
      if (ev.target!== phoneInfoIcon && !phoneTooltip.contains(ev.target)) {
        phoneTooltip.style.display='none';
      }
    });

    /* ==========================
       (E) –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ kaucie
       ========================== */
    const kaucieLink = document.getElementById('kaucieLink');
    const kaucieModalOverlay = document.getElementById('kaucieModalOverlay');
    const kaucieModalClose = document.getElementById('kaucieModalClose');

    kaucieLink.addEventListener('click', (event) => {
      event.preventDefault();
      kaucieModalOverlay.style.display = 'block';
    });
    kaucieModalClose.addEventListener('click', () => {
      kaucieModalOverlay.style.display = 'none';
    });
    kaucieModalOverlay.addEventListener('click', (event) => {
      if (event.target === kaucieModalOverlay) {
        kaucieModalOverlay.style.display = 'none';
      }
    });

    /* ==========================
       (F) –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —à–∞–≥–∞–º
       ========================== */
    document.getElementById('btnStep1Next').addEventListener('click', () => {
      if (validateStep1()) {
        showStep(2);
      }
    });
    document.getElementById('btnStep2Back').addEventListener('click', () => {
      showStep(1);
    });
    document.getElementById('btnStep2Next').addEventListener('click', () => {
      if (validateStep2()) {
        autoSetPhoneCodeByCountry();
        showStep(3);
        checkStep3Validity();
      }
    });
    document.getElementById('btnStep3Back').addEventListener('click', () => {
      showStep(2);
    });

    function validateStep1() {
      let valid = true;
      if (!typSkladu.value) valid = false;
      if (!lokalita.value) valid = false;
      if (!document.querySelector('#prenajat_sklad_od').value) valid = false;
      if (!velkost.value) valid = false;
      if (!cislo.value) valid = false;

      const dobaSel = document.querySelector('input[name="doba_prenajmu"]:checked');
      if (!dobaSel) valid = false;

      if (!valid) {
        alert("Pros√≠m, vypl≈àte v≈°etky polia v Krok 1 (V√Ωber skladu).");
      }
      return valid;
    }

    function validateStep2() {
      let valid = true;
      const pravneVal = pravneSelect.value;
      if (!pravneVal) valid = false;

      if (pravneVal === "Fyzick√° osoba") {
        if (!menoField.value.trim()) valid = false;
        if (!datumNarodenia.value) valid = false;
        const ulica = document.querySelector('#id_ulica').value.trim();
        const cisloD = document.querySelector('#id_cislo_domu').value.trim();
        const pscVal = document.querySelector('#id_psc').value.trim();
        const mestoVal=document.querySelector('#id_mesto').value.trim();
        const krajVal= document.querySelector('#id_krajina').value;
        if (!ulica || !cisloD || !pscVal || !mestoVal || !krajVal) valid = false;
      }
      else if (pravneVal==="Pr√°vnick√° osoba (bez DPH)"|| pravneVal==="Pr√°vnick√° osoba (platca DPH)") {
        if (!nazovField.value.trim()) valid = false;
        const zast = document.querySelector('#id_zastupeny').value.trim();
        if (!zast) valid = false;
        const icoVal  = document.querySelector('#id_ico').value.trim();
        const dicVal  = document.querySelector('#id_dic').value.trim();
        if (!/^(\d{8})$/.test(icoVal))  valid = false;
        if (!/^(\d{10})$/.test(dicVal)) valid = false;
        if (pravneVal==="Pr√°vnick√° osoba (platca DPH)") {
          const icDphVal = document.querySelector('#id_ic_dph').value.trim();
          if (!/^[A-Za-z]{2}\d{10}$/.test(icDphVal)) valid = false;
        }
        const sulica= document.querySelector('#id_sidlo_ulica').value.trim();
        const scdomu= document.querySelector('#id_sidlo_cislo_domu').value.trim();
        const spsc  = document.querySelector('#id_sidlo_psc').value.trim();
        const smest = document.querySelector('#id_sidlo_mesto').value.trim();
        const skraj = document.querySelector('#id_sidlo_krajina').value.trim();
        if(!sulica||!scdomu||!spsc||!smest||!skraj) valid = false;
      }
      if(!valid) {
        alert("Pros√≠m, vypl≈àte v≈°etky polia v Krok 2 (√ödaje n√°jomcu) spr√°vne.");
      }
      return valid;
    }

    function autoSetPhoneCodeByCountry() {
      // 1) –£–∑–Ω–∞—ë–º, –∫—Ç–æ: fyzick√° osoba –∏–ª–∏ pr√°vnick√°?
      const pravneVal = document.querySelector('#id_pravne_postavenie_najomcu').value;

      // 2) –ï—Å–ª–∏ fyzick√°, –±–µ—Ä—ë–º —Å—Ç—Ä–∞–Ω—É –∏–∑ #id_krajina,
      //    –µ—Å–ª–∏ pr√°vnick√° ‚Äì –∏–∑ #id_sidlo_krajina
      let selectedCountry = "";
      if (pravneVal === "Fyzick√° osoba") {
        selectedCountry = document.getElementById('id_krajina').value;
      } else if (pravneVal==="Pr√°vnick√° osoba (bez DPH)"||pravneVal==="Pr√°vnick√° osoba (platca DPH)") {
        selectedCountry = document.getElementById('id_sidlo_krajina').value;
      }

      // 3) –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ —Å–ª–æ–≤–∞—Ä–µ
      if (selectedCountry && countryToCode[selectedCountry]) {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º phone_codeSelect.value = —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –∫–æ–¥—É
        phoneCodeSelect.value = countryToCode[selectedCountry];
        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â—ë –Ω–µ –≤–≤—ë–ª phone_rest,
        // –º–æ–∂–µ–º –æ–±–Ω—É–ª–∏—Ç—å phone_restInput.value, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å
        if (!phoneRestInput.value.trim()) {
          phoneRestInput.value = "";
        }
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º
        syncPhoneField();
      }
    }

    /* –ü–µ—Ä–≤–∏—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è */
    showStep(currentStepVal);
    updateVisibility();
});
</script>

<!-- –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞—Ç -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const dateField = document.querySelector('#prenajat_sklad_od');
    if (dateField) {
        fetch('/validate-date-range/')
            .then(r=>r.json())
            .then(data=>{
                dateField.min=data.min_date;
                dateField.max=data.max_date;
                if(!dateField.value){
                  dateField.value=data.min_date;
                }
            });
    }
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const birthField = document.querySelector('#id_datum_narodenia');
    if (birthField) {
        fetch('/validate-birth-date-range/')
            .then(r=>r.json())
            .then(data=>{
                birthField.min=data.min_date;
                birthField.max=data.max_date;
            });
    }
});
</script>

<!-- Inline-–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ blur -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const textFields = [
        { id: 'id_meno_a_priezvisko', pattern: /^[A-Za-z\-]+(?:\s[A-Za-z\-]+){1,3}$/, errMsg: "Meno a priezvisko mus√≠ obsahova≈• 2 a≈æ 4 slov√°, len p√≠smen√° a pomlƒçky." },
        { id: 'id_ulica',            pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_cislo_domu',       pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_psc',              pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_mesto',            pattern: null, errMsg: "Toto pole je povinn√©." },

        { id: 'id_nazov',            pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_zastupeny',        pattern: /^[A-Za-z\-]+(?:\s[A-Za-z\-]+){1,3}$/, errMsg: "Zast√∫pen√Ω mus√≠ obsahova≈• Meno a Priezvisko, len p√≠smen√° a pomlƒçky." },

        { id: 'id_sidlo_ulica',      pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_sidlo_cislo_domu', pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_sidlo_psc',        pattern: null, errMsg: "Toto pole je povinn√©." },
        { id: 'id_sidlo_mesto',      pattern: null, errMsg: "Toto pole je povinn√©." },

        { id: 'id_ico',              pattern: /^\d{8}$/, errMsg: "IƒåO mus√≠ ma≈• presne 8 ƒç√≠slic." },
        { id: 'id_dic',              pattern: /^\d{10}$/, errMsg: "DIƒå mus√≠ ma≈• presne 10 ƒç√≠slic." },
        { id: 'id_ic_dph',           pattern: /^[A-Za-z]{2}\d{10}$/, errMsg: "Iƒå DPH mus√≠ ma≈• form√°t XX********** (2 p√≠smen√° + 10 ƒç√≠slic)." },

        // –ù–û–í–´–ô: –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–∞—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞ dd.mm.yyyy (>=18)
        { id: 'id_datum_narodenia',  pattern: null, errMsg: "Podƒæa z√°kona si m√¥≈æete prenaja≈• sklad iba od 18 rokov." },

        { id: 'id_email', pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/, errMsg: "Nespr√°vny form√°t e-mailu." },
        { id: 'id_heslo', pattern: /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*\W).+$/, errMsg: "Heslo mus√≠ obsahova≈• veƒæk√© p√≠smeno, mal√© p√≠smeno, ƒç√≠slicu a ≈°peci√°lny znak." }
    ];

    function isFieldVisible(elem) {
        if (!elem) return false;
        return !elem.closest('.hidden');
    }

    textFields.forEach(fi => {
        const el = document.getElementById(fi.id);
        if (!el) return;

        el.addEventListener('blur', function() {
            if (!isFieldVisible(el)) {
                clearError(el, fi.id);
                return;
            }
            const val = el.value.trim();

            if (!val) {
                showError(el, fi.id, fi.errMsg);
                return;
            }

            // –ï—Å–ª–∏ —ç—Ç–æ 'id_datum_narodenia', –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç
            if (fi.id === 'id_datum_narodenia') {
                // –ë—É–¥–µ—Ç —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ "2024-10-02"
                const parts = val.split('-');
                if (parts.length !== 3) {
                    showError(el, fi.id, "Neplatn√Ω d√°tum (oƒçek√°vame yyyy-mm-dd).");
                    return;
                } else {
                    const year  = parseInt(parts[0], 10);
                    const month = parseInt(parts[1], 10) - 1;  // JS 0..11
                    const day   = parseInt(parts[2], 10);

                    const birthDate = new Date(year, month, day);
                    if (isNaN(birthDate.getTime())) {
                        showError(el, fi.id, "Neplatn√Ω d√°tum (ned√° sa zparsova≈•).");
                        return;
                    }
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç
                    const now = new Date();
                    let age = now.getFullYear() - birthDate.getFullYear();
                    const m = now.getMonth() - birthDate.getMonth();
                    if (m < 0 || (m === 0 && now.getDate() < birthDate.getDate())) {
                        age--;
                    }
                    if (age < 18) {
                        showError(el, fi.id, "Podƒæa z√°kona si m√¥≈æete prenaja≈• sklad iba od 18 rokov.");
                        return;
                    }
                }
            }

            // –ï—Å–ª–∏ –µ—Å—Ç—å fi.pattern, –ø—Ä–æ–≤–µ—Ä—è–µ–º
            if (fi.pattern && !fi.pattern.test(val)) {
                showError(el, fi.id, fi.errMsg);
                return;
            }
            // –í—Å—ë –æ–∫
            clearError(el, fi.id);
        });
    });

    function showError(inputEl, id, msg) {
        inputEl.classList.add('invalid-input');
        const errSpan = document.getElementById('error_' + id);
        if (errSpan) {
            errSpan.textContent = msg;
            errSpan.classList.add('active');
        }
    }

    function clearError(inputEl, id) {
        inputEl.classList.remove('invalid-input');
        const errSpan = document.getElementById('error_' + id);
        if (errSpan) {
            errSpan.textContent = '';
            errSpan.classList.remove('active');
        }
    }
});
</script>

</body>
</html>
